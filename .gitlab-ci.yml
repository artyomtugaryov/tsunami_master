image: ubuntu:16.04

variables:
  GIT_SUBMODULE_STRATEGY: recursive
  
cache:
  key: apt-cache
  paths:
  - apt-cache/

stages:
- build

before_script:
- export APT_CACHE_DIR=`pwd`/apt-cache && mkdir -pv $APT_CACHE_DIR
- apt-get update -qq
- apt-get -o dir::cache::archives="$APT_CACHE_DIR" install -y build-essential cmake qtbase5-dev=5.11 libqt5svg5-dev=5.11 qt5-default=5.11 qtdeclarative5-dev=5.11

build_TM:
  stage: build
  script:
  - mkdir build && cd build
  - cmake ../
  - qmake --version
  - make -j32 TMlib TMLibTests
  artifacts:
    paths:
    - bin
